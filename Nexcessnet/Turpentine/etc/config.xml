<?xml version="1.0"?>
<config>
    <modules>
        <Nexcessnet_Turpentine>
            <version>0.0.1</version>
        </Nexcessnet_Turpentine>
    </modules>
    <default>
        <turpentine_servers>
            <backend>
                <backend_host>127.0.0.1</backend_host>
                <backend_port>8080</backend_port>
            </backend>
            <servers>
                <version>Auto</version>
                <server_list>127.0.0.1:6082</server_list>
                <config_file>{{root_dir}}/var/default.vcl</config_file>
            </servers>
            <debug>
                <headers>1</headers>
            </debug>
        </turpentine_servers>
        <turpentine_control>
            <general>
                <enable>1</enable>
            </general>
            <ttls>
                <default_ttl>3600</default_ttl>
                <url_ttls>$,300</url_ttls>
            </ttls>
            <urls>
                <url_whitelist>.*</url_whitelist>
                <url_blacklist><![CDATA[wishlist
catalog/product_compare
checkout
customer]]></url_blacklist>
            </urls>
            <params>
                <get_params>__SID</get_params>
            </params>
            <purging>
                <auto_purge_actions></auto_purge_actions>
            </purging>
        </turpentine_control>
    </default>
    <global>
        <blocks>
            <turpentine>
                <class>Nexcessnet_Turpentine_Block</class>
            </turpentine>
        </blocks>
        <helpers>
            <turpentine>
                <class>Nexcessnet_Turpentine_Helper</class>
            </turpentine>
        </helpers>
        <models>
            <turpentine>
                <class>Nexcessnet_Turpentine_Model</class>
            </turpentine>
        </models>
        <events>
            <customer_login>
                <observers>
                    <turpentine>
                        <class>turpentine/observer</class>
                        <method>disableVarnishCaching</method>
                    </turpentine>
                </observers>
            </customer_login>
            <customer_logout>
                <observers>
                    <turpentine>
                        <class>turpentine/observer</class>
                        <method>enableVarnishCaching</method>
                    </turpentine>
                </observers>
            </customer_logout>
            <wishlist_add_item>
                <observers>
                    <turpentine>
                        <class>turpentine/observer</class>
                        <method>disableVarnishCaching</method>
                    </turpentine>
                </observers>
            </wishlist_add_item>
            <wishlist_add_product>
                <observers>
                    <turpentine>
                        <class>turpentine/observer</class>
                        <method>disableVarnishCaching</method>
                    </turpentine>
                </observers>
            </wishlist_add_product>
            <customer_register_success>
                <observers>
                    <turpentine>
                        <class>turpentine/observer</class>
                        <method>disableVarnishCaching</method>
                    </turpentine>
                </observers>
            </customer_register_success>
            <checkout_cart_add_product_complete>
                <observers>
                    <turpentine>
                        <class>turpentine/observer</class>
                        <method>disableVarnishCaching</method>
                    </turpentine>
                </observers>
            </checkout_cart_add_product_complete>
        </events>
    </global>
    <admin>
        <routers>
            <adminhtml>
                <args>
                    <modules>
                        <turpentine after="Mage_Adminhtml">Nexcessnet_Turpentine</turpentine>
                    </modules>
                </args>
            </adminhtml>
        </routers>
    </admin>
    <adminhtml>
        <menu>
            <system>
                <children>
                    <turpentine translate="title" module="turpentine">
                        <title>Varnish Management</title>
                        <action>adminhtml/varnish_management</action>
                        <sort_order>91</sort_order>
                    </turpentine>
                </children>
            </system>
        </menu>
        <layout>
            <updates>
                <turpentine module="turpentine">
                    <file>turpentine.xml</file>
                </turpentine>
            </updates>
        </layout>
        <acl>
            <resources>
                <admin>
                    <children>
                        <system>
                            <children>
                                <turpentine translate="title" module="turpentine">
                                    <title>Turpentine Varnish Management</title>
                                </turpentine>
                                <config>
                                    <children>
                                        <turpentine_servers translate="title" module="turpentine">
                                            <title>Turpentine Varnish Options</title>
                                        </turpentine_servers>
                                        <turpentine_control translate="title" module="turpentine">
                                            <title>Turpentine Caching Options</title>
                                        </turpentine_control>
                                    </children>
                                </config>
                            </children>
                        </system>
                    </children>
                </admin>
            </resources>
        </acl>
    </adminhtml>
</config>
